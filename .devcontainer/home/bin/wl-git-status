#!/bin/bash
# work-lab git status for tmux status bar
# Shows:  branch ● (modified) or  branch (clean)
# Icon:  = nf-dev-git_branch (Nerd Font)

cd /workspaces/project 2>/dev/null || exit 0

branch=$(git symbolic-ref --short HEAD 2>/dev/null || git rev-parse --short HEAD 2>/dev/null)
[[ -z "$branch" ]] && exit 0

# Truncate long branch names (tmux2k style: max 20 chars)
[[ ${#branch} -gt 20 ]] && branch="${branch:0:17}..."

# Check for uncommitted changes
if git diff --quiet 2>/dev/null && git diff --cached --quiet 2>/dev/null; then
  echo " $branch"
else
  echo " $branch ●"
fi
