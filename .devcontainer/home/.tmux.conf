# work-lab tmux config
# Optimized for AI coding agents (gastown, claude, etc.)

# Enable mouse support
set -g mouse on

# Start window numbering at 1
set -g base-index 1
setw -g pane-base-index 1

# ─────────────────────────────────────────────────────────────────────────────
# Status bar - matching work-lab color palette
# ─────────────────────────────────────────────────────────────────────────────
# Colors: cyan #50c8dc, sky blue #64a0dc, gold #ffd23c, dim #8c969f
# Background: dark charcoal for depth without pure black glare

set -g status-style 'bg=#1a1a1f fg=#c8c8c8'
set -g status-position bottom
set -g status-justify left
set -g status-left-length 40
set -g status-right-length 60

# Left: session name in cyan, project name in white
set -g status-left '#[fg=#50c8dc,bold][#S]#[default] #[fg=#ffffff]#(wl-project-name)#[default]  '

# Right: git branch (sky blue) │ devcontainer status ⚡dc (gold) │ time (dim)
set -g status-right '#[fg=#64a0dc]#(wl-git-status)#[default] #[fg=#ffd23c]#(wl-dc-status)#[default] #[fg=#8c969f]%H:%M#[default] '

# Window tabs: current window stands out
set -g window-status-format '#[fg=#666666] #I:#W '
set -g window-status-current-format '#[fg=#50c8dc,bold] #I:#W '
set -g window-status-separator ''

# Pane borders: subtle
set -g pane-border-style 'fg=#333333'
set -g pane-active-border-style 'fg=#50c8dc'

# Message styling
set -g message-style 'bg=#1a1a1f fg=#50c8dc'

# Refresh status bar every 5 seconds (for git status updates)
set -g status-interval 5

# Large scrollback for reviewing agent output
set -g history-limit 50000

# Reduce escape delay (better for vim users)
set -sg escape-time 10

# True color support
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# Monitor activity in other panes
setw -g monitor-activity on
set -g visual-activity off

# Devcontainer attachment
# prefix + D opens a new window attached to the project's devcontainer (via docker exec)
# prefix + S opens SSH tunnel to devcontainer (requires sshd feature)
# Useful for sidecar mode where the project has its own devcontainer
# The [dc] prefix clearly indicates this window is connected to the devcontainer
bind D new-window -n '[dc] shell' 'dc-attach || read -p "Press Enter to close..."'
bind S new-window -n '[dc] ssh' 'dc-ssh || read -p "Press Enter to close..."'

# Session save/restore
# prefix + W saves current session layout (persists across container rebuilds)
bind W run-shell 'wl-session-save && tmux display-message "Session saved"'

# Source user overrides if present
if-shell "[ -f ~/.config/work-lab/tmux.conf.local ]" "source-file ~/.config/work-lab/tmux.conf.local"
